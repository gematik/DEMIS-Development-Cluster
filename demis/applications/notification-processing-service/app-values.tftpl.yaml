# Values for notification-processing-service

debug:
  enable: ${debug_enable}

istio:
  enable: ${istio_enable}

required:
  image: 
    repository: ${repository}
    %{ if strcontains(repository, "gematik1") }
    name: demis-notification-processing-service
    %{ endif }
      
# Image Pull Secrets
imagePullSecrets: 
  %{~ for pull_secret in image_pull_secrets ~}
  - name: ${pull_secret}
  %{~ endfor ~}

podAnnotations:
  checksum/redis_reader: "${redis_cus_reader_credentials_checksum}"
  %{~ if feature_flag_new_istio_sidecar_requests_and_limits && istio_proxy_resources != null ~}
  sidecar.istio.io/proxyCPU: ${istio_proxy_resources.requests.cpu}
  sidecar.istio.io/proxyMemory: ${istio_proxy_resources.requests.memory}
  sidecar.istio.io/proxyMemoryLimit: ${istio_proxy_resources.limits.memory}
  %{endif}
  
customEnvVars:
  # Prevents empty values that can delete the default environment variables
  TERRAFORM_DEPLOYMENT: true
  REDIS_USER: "${redis_user}"
  REDIS_HOST: "redis-cus.idm.svc.cluster.local"
  NPS_CLIENT_VALIDATION: http://validation-service.${namespace}.svc.cluster.local
  NPS_CLIENT_LIFECYCLE_VS: http://lifecycle-validation-service.${namespace}.svc.cluster.local
  NPS_CLIENT_ROUTING: http://notification-routing-service.${namespace}.svc.cluster.local
  NPS_CLIENT_PDFGEN: http://pdfgen-service.${namespace}.svc.cluster.local
  NPS_CLIENT_PSEUDONYMIZATION: http://pseudonymization-service.${namespace}.svc.cluster.local
  NPS_CLIENT_PSEUDO_STORAGE: http://pseudonymization-storage-service.${namespace}.svc.cluster.local
  NPS_CLIENT_FHIR_STORAGE_WRITER_ADDRESS: http://fhir-storage-writer.${namespace}.svc.cluster.local
  NPS_CLIENT_FUTS_ADDRESS: http://futs.${namespace}.svc.cluster.local
  DEMIS_CODEMAPPING_BASE_URL: http://futs.${namespace}.svc.cluster.local
  NPS_CLIENT_CONTEXT_ENRICHMENT_SERVICE: http://context-enrichment-service.${namespace}.svc.cluster.local
  NPS_CLIENT_DLS: http://destination-lookup-writer.${namespace}.svc.cluster.local
  %{~ for flag_name, flag_value in feature_flags ~}
  ${flag_name} : ${flag_value}
  %{~ endfor ~}
  %{~ for config_name, config_value in config_options ~}
  ${config_name} : "${config_value}"
  %{~ endfor ~}


%{~ if replica_count != null ~}
# Number of Pod Replicas desired
replicaCount: ${replica_count}
%{endif}

%{~ if resource_block != null ~}
# Override Resource Definitions for Pod
${resource_block}
%{endif}
